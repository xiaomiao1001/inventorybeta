# 郭四车行库存管理系统 PRD

## 1. 产品概述

### 1.1 微信小程序名称
**郭四车行库存管理系统**

### 1.2 产品定位
解决车辆库存管理问题，实现车辆库存信息的数字化管理，包括库存查看、出库入库记录、客户信息管理、赊欠管理等功能，提升车行运营效率。

### 1.3 目标用户
- **销售人员**：查看库存信息，执行车辆零售出库操作
- **管理员**：查看和编辑各类数据表，进行库存管理
- **所有者**：拥有系统全部功能权限
- **经销商**：（后续开发，暂不涉及具体权限）

## 2. 功能需求

### 2.1 用户权限管理
#### 2.1.1 角色定义
- **所有者**：全部权限
- **管理员**：查看编辑表权限
- **销售人员**：查看库存信息、填写车辆零售出库表
- **经销商**：待后续开发

#### 2.1.2 权限控制
- 基于角色的访问控制（RBAC）
- 登录验证和身份识别
- 操作日志记录

### 2.2 库存管理功能

#### 2.2.1 库存查看
- **鸿日车库存查看**
  - 表头：VIN码、车型系列、车型、配置、颜色、总部出库日期、入库日期、库存状态
- **二手车库存查看**
  - 表头：品牌、颜色、入库日期（自动获取）、来源（自动获取客户姓名）、收车价格（自动获取客户旧车折抵价格）、库存状态（默认在库，可修改）、操作人
- **其他品牌车库存查看**
  - 表头：VIN码、车型系列、车型、配置、颜色、总部出库日期、入库日期、库存状态

#### 2.2.2 库存添加与编辑
- **鸿日车库存**：支持手动批量添加信息
- **其他品牌车库存**：支持手动批量添加信息
- **二手车库存**：通过旧车折抵自动添加
- 支持编辑和删除库存信息

### 2.3 车辆出库功能

#### 2.3.1 零售出库
适用于三种库存的零售出库，包含以下信息录入：

**客户信息**
- 身份证照片（支持OCR识别提取：姓名、性别、身份证号、地址）
- 电话号码
- 地址

**支付信息**
- **支付方式**：
  - 扫码支付（带填写框：支付金额）
  - 现金支付
  - 银行转账（带填写框：转账金额）

**销售信息**
- 销售日期
- 销售人
- 发票照片
- 合格证照片
- 是否下户（勾选项）

**赊欠信息**（勾选展示）
- 赊欠金额
- 欠款约定还款日期

**旧车折抵信息**（勾选展示）
- 旧车折抵金额
- 旧车品牌
- 旧车颜色
- 自动添加到二手车库存中

#### 2.3.2 批发出库
**第一页面：选择出库库存**
- 从三个库存中选择：鸿日车库存、二手车库存、其他品牌车库存

**第二页面：批发出库信息录入**
- **车辆选择**：弹出库存详情，选中车辆后显示VIN码
- **经销商名称**：文本输入
- **经销商等级**：系统根据经销商名称自动判断
  - 高级批发商：采用旗县经销商价格
  - 低级批发商：采用乡镇经销商价格
- **提车时间**：日期选择
- **增加配置**：勾选+填写框组合
  - 锂电池、锂电池加工费、铅酸电池折抵、方向助力、增程器、柴暖、铝轮、坐垫脚垫、轮毂盖、保险装车费、运费、利润、奖励核减
  - 填写经销商名称时，自动调用经销商配置价格表填入各项价格
- **经手人**：文本输入
- **总价计算**：页面底部自动计算

### 2.4 身份证识别功能
- 支持拍照或相册选择身份证图片
- OCR识别提取：姓名、性别、身份证号、地址
- 自动填入客户信息表单

### 2.5 数据统计与报表
- 销售统计报表
- 库存统计报表
- 数据导出功能：
  - **客户信息表导出**：包含所有客户的基本信息和交易记录
  - **库存明细表导出**：三种库存的详细信息
  - **月度销售报表导出**：按月统计的销售数据
- 按时间段、车型、经销商等维度统计

### 2.6 赊欠管理
- 赊欠信息记录与查询
- **还款提醒功能**：通过小程序消息推送提醒
- 赊欠账单管理
- 还款记录跟踪

## 3. 非功能需求

### 3.1 用户体验
- 页面简单易用，操作流程清晰
- 响应式设计，支持手机端浏览
- 界面美观，符合微信小程序设计规范

### 3.2 性能要求
- 页面加载时间不超过3秒
- 支持离线数据缓存
- 图片上传和识别响应及时

### 3.3 安全性
- 角色权限管理
- 数据传输加密
- **操作日志记录**：记录所有用户的操作历史（谁在什么时候添加/修改了哪些信息）
- 数据备份机制

## 4. 技术方案

### 4.1 开发工具与技术栈
- **前端开发**：Cursor
- **后端数据库**：腾讯云开发
- **身份证识别**：火山引擎 Ark API
- **小程序框架**：微信原生小程序

### 4.2 数据库设计

#### 4.2.1 数据表结构

**车辆价格表**
- 车型系列、车型、出厂配置、政策优惠、旗县经销商价格、乡镇经销商价格

**鸿日车库存表**
- VIN码、车型系列、车型、配置、颜色、总部出库日期、入库日期、库存状态

**二手车库存表**
- 品牌、颜色、入库日期、来源、收车价格、库存状态、操作人

**其他品牌车库存表**
- VIN码、车型系列、车型、配置、颜色、总部出库日期、入库日期、库存状态

**销售明细表**
- 销售日期、车辆信息、客户信息、销售金额、销售类型（零售/批发）、经手人等

**客户信息表**
- 姓名、性别、身份证号、电话、地址、身份证照片等

**赊欠信息表**
- 客户ID、赊欠金额、约定还款日期、实际还款日期、还款状态、提醒状态等

**操作日志表**
- 操作人、操作时间、操作类型、操作对象、操作前数据、操作后数据等

**经销商配置价格表**
- 经销商名称、各配置项价格（锂电池、锂电池加工费、铅酸电池折抵、方向助力、增程器、柴暖、铝轮、坐垫脚垫、轮毂盖、保险装车费、运费、利润、奖励核减）
- 支持的经销商地区：新街、后旗、沙海、蛮会、棋盘井、磴口、二道桥、三道桥、阿拉善左旗、五原、头道桥、乌海海南、天吉泰、乌达、额济纳旗、前旗、千里山、碱贵、德令山、乌审旗、塔尔湖

## 5. 开发计划

### 5.1 开发阶段
1. **第一阶段**：前端页面开发、页面跳转逻辑梳理
   - 设计所有页面的UI界面
   - 梳理页面间的跳转逻辑和导航结构
   - 确定数据传递方式和页面状态管理
   - 完成静态页面的交互效果

2. **第二阶段**：基础表、核心表搭建
   - 设计并创建数据库表结构
   - 建立表与表之间的关联关系
   - 设置索引和约束条件
   - 初始化基础数据和配置数据

3. **第三阶段**：后端数据库连接
   - 配置腾讯云开发环境
   - 建立小程序与数据库的连接
   - 实现基础的CRUD操作接口
   - 测试数据库连接稳定性

4. **第四阶段**：用户权限系统开发
   - 实现用户登录认证功能
   - 开发角色权限管理模块
   - 建立操作日志记录机制
   - 测试权限控制有效性

5. **第五阶段**：库存管理功能开发
   - 实现库存查看、添加、编辑功能
   - 开发批量添加库存功能
   - 完成库存状态管理
   - 测试库存数据准确性

6. **第六阶段**：零售出库功能开发
   - 集成火山引擎身份证识别API
   - 开发客户信息录入功能
   - 实现支付信息和销售信息管理
   - 完成赊欠和旧车折抵逻辑

7. **第七阶段**：批发出库功能开发
   - 开发经销商价格配置功能
   - 实现批发出库流程
   - 完成价格自动计算逻辑
   - 测试批发业务流程

8. **第八阶段**：统计报表和赊欠管理
   - 开发数据统计分析功能
   - 实现报表导出功能
   - 完成赊欠管理和提醒功能
   - 测试统计数据准确性

9. **第九阶段**：系统优化和集成测试
   - 性能优化和bug修复
   - 完整业务流程测试
   - 用户体验优化
   - 安全性测试

10. **第十阶段**：部署上线和验收
    - 生产环境部署
    - 用户培训和使用指导
    - 功能验收和性能测试
    - 项目交付和后续维护计划

### 5.2 预估工期
总体开发周期：14-16周

**各阶段预估工期：**
- 第一阶段（前端页面）：2周
- 第二阶段（数据库设计）：1周  
- 第三阶段（数据库连接）：1周
- 第四阶段（权限系统）：2周
- 第五阶段（库存管理）：2周
- 第六阶段（零售出库）：2周
- 第七阶段（批发出库）：2周
- 第八阶段（统计报表）：2周
- 第九阶段（系统优化）：1周
- 第十阶段（部署验收）：1周

## 6. 验收标准

### 6.1 功能验收
- 所有功能模块正常运行
- 用户权限控制有效
- 数据录入和查询准确
- 统计报表数据正确

### 6.2 性能验收
- 页面加载速度符合要求
- 图片识别准确率达到95%以上
- 系统稳定性良好

### 6.3 用户体验验收
- 界面美观易用
- 操作流程顺畅
- 移动端适配良好

---

*本PRD文档版本：V1.0*  
*创建日期：2025年6月7日*  
*产品经理：[姓名]*