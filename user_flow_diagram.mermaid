flowchart TD
    A[进入小程序] --> B[用户登录/身份验证]
    B --> C{角色判断}
    
    C -->|所有者| D[所有者主页]
    C -->|管理员| E[管理员主页]
    C -->|销售人员| F[销售人员主页]
    C -->|经销商| G[经销商主页<br/>待开发]
    
    %% 所有者功能流程
    D --> D1[查看库存管理]
    D --> D2[销售出库管理]
    D --> D3[数据统计报表]
    D --> D4[赊欠管理]
    D --> D5[系统设置]
    D --> D6[用户权限管理]
    
    %% 管理员功能流程
    E --> E1[库存管理]
    E --> E2[数据表编辑]
    E --> E3[统计报表查看]
    
    %% 销售人员功能流程
    F --> F1[查看库存信息]
    F --> F2[零售出库操作]
    
    %% 库存管理详细流程
    D1 --> H1[选择库存类型]
    E1 --> H1
    F1 --> H1
    H1 --> H2[鸿日车库存]
    H1 --> H3[二手车库存]
    H1 --> H4[其他品牌车库存]
    
    H2 --> H5[查看库存列表]
    H2 --> H6[批量添加车辆]
    H2 --> H7[编辑车辆信息]
    H2 --> H8[删除车辆信息]
    
    H3 --> H9[查看二手车列表]
    H3 --> H10[编辑二手车信息]
    
    H4 --> H11[查看其他品牌列表]
    H4 --> H12[批量添加车辆]
    H4 --> H13[编辑车辆信息]
    
    %% 零售出库流程
    D2 --> I1[选择出库类型]
    F2 --> I1
    I1 --> I2[零售出库]
    I1 --> I3[批发出库]
    
    %% 零售出库详细流程
    I2 --> J1[选择车辆库存]
    J1 --> J2[选择具体车辆]
    J2 --> J3[录入客户信息]
    J3 --> J4[拍摄身份证]
    J4 --> J5[OCR自动识别填入]
    J5 --> J6[补充电话和地址]
    J6 --> J7[录入支付信息]
    J7 --> J8[选择支付方式<br/>可多选]
    J8 --> J9[扫码支付金额]
    J8 --> J10[现金支付金额]
    J8 --> J11[银行转账金额]
    J9 --> J12[录入销售信息]
    J10 --> J12
    J11 --> J12
    J12 --> J13[选择销售日期]
    J13 --> J14[输入销售人]
    J14 --> J15[上传发票照片]
    J15 --> J16[上传合格证照片]
    J16 --> J17[选择是否下户]
    J17 --> J18{是否有赊欠}
    J18 -->|是| J19[录入赊欠信息]
    J18 -->|否| J20{是否有旧车折抵}
    J19 --> J20
    J20 -->|是| J21[录入旧车信息]
    J20 -->|否| J22[确认提交出库]
    J21 --> J23[自动添加到二手车库存]
    J23 --> J22
    J22 --> J24[生成出库单据]
    J24 --> J25[更新库存状态]
    
    %% 批发出库详细流程
    I3 --> K1[选择出库库存类型]
    K1 --> K2[选择具体车辆]
    K2 --> K3[录入经销商名称]
    K3 --> K4[系统判断经销商等级]
    K4 --> K5[自动加载配置价格]
    K5 --> K6[选择提车时间]
    K6 --> K7[勾选增加配置]
    K7 --> K8[填写各配置价格]
    K8 --> K9[输入经手人]
    K9 --> K10[系统计算总价]
    K10 --> K11[确认提交出库]
    K11 --> K12[生成批发单据]
    K12 --> K13[更新库存状态]
    
    %% 数据统计报表流程
    D3 --> L1[选择报表类型]
    E3 --> L1
    L1 --> L2[销售统计报表]
    L1 --> L3[库存统计报表]
    L1 --> L4[数据导出功能]
    
    L2 --> L5[按时间段筛选]
    L2 --> L6[按车型筛选]
    L2 --> L7[按经销商筛选]
    
    L4 --> L8[导出客户信息表]
    L4 --> L9[导出库存明细表]
    L4 --> L10[导出月度销售报表]
    
    %% 赊欠管理流程
    D4 --> M1[查看赊欠列表]
    M1 --> M2[筛选赊欠状态]
    M1 --> M3[查看还款提醒]
    M1 --> M4[记录还款信息]
    M1 --> M5[生成赊欠账单]
    
    M3 --> M6[小程序消息推送]
    
    %% 系统设置流程
    D5 --> N1[价格配置管理]
    D5 --> N2[经销商配置管理]
    D5 --> N3[操作日志查看]
    
    N1 --> N4[编辑车辆价格表]
    N2 --> N5[编辑经销商配置价格]
    N3 --> N6[查看操作历史记录]
    
    %% 返回主页
    J25 --> O[返回主页]
    K13 --> O
    L10 --> O
    M6 --> O
    N6 --> O
    
    %% 样式定义
    classDef startEnd fill:#e1f5fe
    classDef process fill:#f3e5f5
    classDef decision fill:#fff3e0
    classDef userRole fill:#e8f5e8
    classDef important fill:#ffebee
    
    class A,O startEnd
    class D,E,F,G userRole
    class C,J18,J20 decision
    class J22,K11,J24,K12 important